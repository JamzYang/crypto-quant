## 一、市场与交易基础相关概念
### 1. 现货（Spot）VS 合约（Futures / 永续合约）
    多（long）
    空（short）
### 2. 杠杆Leverage

量化视角：  
- 风控模块必须对“实际杠杆倍数”和“账户最大允许杠杆”做严格控制。

### 3. 强平（强制平仓）

量化视角：  
- 风控要提前止损，不能让策略“等到强平”才出场。
- 回测时要根据交易所规则模拟强平，否则收益会被严重高估。


### 4. 资金费率（Funding Rate）

- **出现在哪**
  - 主要存在于**永续合约**（Perpetual Futures）中。

- **作用**
  - 用来让永续合约的价格尽量贴近现货价格。
  - 当合约价格高于现货时，通常多头（做多）定期付钱给空头。
  - 当合约价格低于现货时，空头定期付钱给多头。

- **对交易者的影响**
  - 你持有仓位时间越久，资金费率的影响越明显。
  - 有的策略专门赚资金费率（比如“搬砖+收 funding”）。

量化视角：  
- 模型中要把资金费率作为“成本”或“收益”计入回测，否则中长期策略表现会失真。

### 5. 手续费（Fee）

- **分类**
  - 挂单（Maker）费：你下限价单，提供流动性。
  - 吃单（Taker）费：你用市价单/立即成交的限价单，吃掉订单簿里的流动性。

- **特点**
  - 对高频和中频策略影响巨大。
  - 很多策略在“扣除手续费后”直接从赚钱变成亏钱。

量化视角：  
- 回测引擎中必须精确扣减手续费（按交易所实际费率设置）。


### 6. 滑点（Slippage）

- **定义**
  - 你“预期”的成交价格和“实际”成交价格之间的差异。
  - 例如你看到 BTC = 60000，点击市价买入 10 BTC，实际平均成交价可能变成 60050。

- **来源**
  - 深度不够：大单吃穿多档挂单。
  - 波动剧烈：下单到成交之间价格大幅变化。
  - 交易所撮合延迟等。

量化视角：  
- 回测要对滑点做合理假设。
- 执行层要做“拆单”“限价+容忍区间”等控制滑点的手段。
- 要根据「历史盘口深度」去估计滑点，否则回测是纸上谈兵
- 冷门币种 / 深度差的合约滑点可能远大于手续费。


### 7. 交易限制（最小下单量、频率限制）

---

## 二、量化系统组成的各层

### 1. 数据层

- **职责**
  - 采集：K线、成交明细、订单簿、资金费率、标记价格等。
  - 清洗：去异常、补数据、对齐不同交易所/不同周期。
  - 存储：数据库、文件、数据湖等，保证可回放、可复现。

- **和前面概念的关系**
  - 会记录手续费率、资金费率、交易规则（最小量、tick size）等元数据。


### 2. 策略 / 信号层

- **职责**
  - 从数据中提取特征（因子），生成买入/卖出/加减仓信号。
  - 例如：动量策略、均值回归、套利、资金费率策略等。


### 3. 回测层

- **职责**
  - 用历史数据模拟真实交易，把策略逻辑“跑一遍”。
  - 输出收益曲线、最大回撤、夏普比率等指标。

- **必须考虑的要素**
  - 手续费、滑点。
  - 交易限制（最小下单量、频率限制）。
  - 合约规则：杠杆、保证金、强平、资金费率。


### 4. 执行层

- **职责**
  - 把“信号”转成实际交易指令并发送到交易所。
  - 决定下单类型（市价/限价）、拆单策略、重试机制等。
  - 处理未成交、部分成交、撤单、重下等细节。

- **和之前概念的关系**
  - 必须遵守交易限制和频率限制。
  - 尝试在可接受的范围内降低滑点。
  - 控制实际杠杆，不让策略突然用到极端高杠杆。


### 5. 风控与监控

- **风控职责**
  - 控制单笔、单日、总账户风险。
  - 设置止损线、最大回撤阈值、最大持仓和杠杆限制。
  - 避免接近强平价，必要时强制减仓或平仓。

- **监控职责**
  - 实时监控：PnL、仓位、资金费率支出、手续费支出等。
  - 监控系统健康：API 错误率、延迟、是否触及频率限制。
  - 预警与告警：异常波动、异常亏损、订单异常等。
